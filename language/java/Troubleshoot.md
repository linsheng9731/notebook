
## 一个典型的客户端集群->LB->服务端集群这样的结构中，如客户端采用连接池，长连接的方式，这种设计你觉得可能会出现什么问题？

发布的时候可能会碰到请求集中到少数几台机器上，分布不均匀。解决方法，限流。客户端改重试机制。

## 当前Java程序的一些启动参数值，例如Heap Size等。

jinfo -flags

## 用什么命令行工具可以查看运行的Java程序的GC状况？

可以用jstat -gcutil [pid] [频率，例如多少毫秒一次] [多少次]来看目前的gc情况，如果已经打开了gc log，可以直接查看gc日志。

## 用什么工具，可以在Java程序运行的情况下跟踪某个方法的执行时间，请求参数信息等，并请解释下工具实现的原理。

btrace，Arthas，主要借助JVM attach agent，ASM以及Instrumentation来动态的替换字节码，从而实现动态的对程序运行情况的跟踪。

## Java进程突然消失了，你会怎么去排查这种问题？

这题也非常开放，通常来说，先去看看java进程的日志，例如有没有hs_err_[pid].log，如果有，看看日志里的内容，相应的来处理；另外可以看看有没有core dump，如果有，用gdb查查看；还可以用dmesg，看看是不是什么原因被os kill了；还有看运维系统的一些操作日志。

## 以下这段代码思路，你觉得在运行时可能会产生的风险是，应该如何改进？

```
public List<User> getUsers(String[] userIds){
       // 从数据库查找符合userIds的user记录
      //  将返回的记录组装为User对象，放入List并返回
}
```
很多同学回复了各种风险，挺好的，我自己回答的话，这题最大的风险是没有限制userIds的个数，可能会导致从数据库里查找大量的数据，并拼装为User对象，一方面可能会使得数据库扛不住，另一方面也有可能导致Java这边OOM了，类似的这样的代码曾经导致过非常严重的故障。（之所以问这个问题，是想提示大家在写代码的过程中要比较好的进行防御性编程。）